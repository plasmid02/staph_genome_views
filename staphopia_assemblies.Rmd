---
title: "Staph genome size distribuiton"
output: html_notebook
---



```{r}
library(staphopia)
library(dplyr)
library(ggplot2)
```


```{r}
public <- get_public_samples()

```

```{r}
gold_samps <- public %>% filter(rank == 3)
contigs <- get_assembly_stats(gold_samps$sample_id)

```

```{r}
mean(contigs$total_contig_length)
sd(contigs$total_contig_length)
```

How does the proportion of small assemblies vary by contig length?

```{r}
p <- ggplot(contigs, aes(x= total_contig_length, y = percent_contigs_greater_1k)) + geom_point()
p 
```

Note the hard line at about 2.7 Mbp?
Also the group of strains with total_length greater than ~ 2.8Mbp but %contigs less than 10%
Interesting set of strains seem to all have genomes of ~ 1.8 Mbp.

Start with the small ones
```{r}
under2Mb <- contigs %>% filter(total_contig_length < 2000000) %>%
  select(sample_id)
under2Mb_meta <- get_metadata(under2Mb$sample_id)
under2Mb_info <- get_samples(under2Mb$sample_id)
```

These are all from Sanger, all ST '0'.  My guess, some sort of contaminant.

```{r}
hist(contigs$total_contig_length, breaks= 500)
```

Interesting set of peaks, especially the one over 3,000,000

```{r}
merged_tables <- inner_join(contigs,public, by = "sample_id")
```

```{r}
filter(merged_tables,total_contig_length > 3000000) %>%
  select(st) %>%
  table()
```
Strikingly, a lot of these large genomes are ST239

```{r}
filter(merged_tables,total_contig_length < 2630000) %>%
  select(st) %>%
  table()
```

As expected?  Check that these maybe have other S. aureus STs?
Get a list of gold St=0 and look st the cgmlst profiles
```{r}
gold_st0 <- filter(gold_samps,st == 0)
gold_st0_cgmlst <- get_cgmlst(gold_st0$sample_id)
```

```{r}
session_info()
```

